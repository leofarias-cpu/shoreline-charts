import { Section } from '@site/src/components/Section'

<Section hasExplanation>

## Usage

```jsx
import {
  FilterDisclosure,
  FilterPopover,
  FilterListbox,
  FilterOptionRadio,
  FilterOptionCheckbox,
  FilterFooter,
  useFilterMultipleState,
  useFilterState,
  useFilterGroupState,
  FilterGroup,
} from '@vtex/admin-ui'

function Example() {
  const filterState = useFilterState()
  const multipleSelectState = useFilterMultipleState()

  const filterGroupState = useFilterGroupState({
    filterStates: [state2, state],
  })

  return(
    <FilterGroup>
      // basic filter
      <FilterDisclosure state={filterState}>Example</FilterDisclosure>

      <FilterPopover state={filterState}>
        <FilterListbox>
          <FilterOptionRadio id="#1" label="Full" />
          <FilterOptionRadio id="#2" label="Empty" />
          <FilterOptionRadio id="#3" label="Half full" />
        </FilterListbox>
        <FilterFooter />
      </FilterPopover>

      // multiple selection filter
      <FilterDisclosure state={multipleSelectState}>Example</FilterDisclosure>

      <FilterPopover state={multipleSelectState}>
        <FilterListbox>
          <FilterOptionCheckbox id="#1" label="Full" />
          <FilterOptionCheckbox id="#2" label="Empty" />
          <FilterOptionCheckbox id="#3" label="Half full" />
        </FilterListbox>
        <FilterFooter />
      </FilterPopover>
    <FilterGroup />
  )
}
```

</Section>

<Section hasExplanation>

## State

The state hooks `useFilterState` and `useFilterMultipleState` contain all business logic needed for
controlling individual filters. The two hooks are different, but they share many props in common.

The state hook `useFilterGroupState` handles the "clear all" action for the `FilterGroup` component.

</Section>

<Section hasExplanation>

### Filter option type

All filter states use the type FilterOption for the listed options. The type T used for value will affect the return type of all state that represents options.

| Name  | Type           | Description                                                                                                              | Required | Default |
| ----- | -------------- | ------------------------------------------------------------------------------------------------------------------------ | -------- | ------- |
| id    | string         | Unique id for this option.                                                                                               | ðŸš«       | -       |
| label | string         | Label that will be rendered for the option.                                                                              | ðŸš«       | -       |
| value | T (any object) | This is an optional value that can have any type. You can use it to manage additional data asssociated with the options. | ðŸš«       | -       |

</Section>

<Section>

### useFilterState and useFilterMultipleState props

| Name           | Type           | Description                                                                       | Required | Default |
| -------------- | -------------- | --------------------------------------------------------------------------------- | -------- | ------- |
| searchableList | FilterOption[] | Full option list that will be used for searching. Only use it if you need search. | ðŸš«       | -       |

</Section>

<Section hasExplanation>

### Shared generic filter state

Both hooks return an object that extends the following type

| Name                | Type                                                | Description                                                                                                                               |
| ------------------- | --------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| onClear             | () => void                                          | Function called when clear button on filter footer is clicked.                                                                            |
| onChange            | () => void                                          | Function called when apply button on filter footer is clicked.                                                                            |
| menu                | MenuState                                           | State that handles the popover menu.                                                                                                      |
| status              | 'error', 'loading', 'ready', 'empty' or 'not-found' | Current status of the filter.                                                                                                             |
| setStatus           | (status: FilterStatus) => void                      | Setter for current status. Only needed on controlled behavior                                                                             |
| setFullList         | (list: FilterOption[]) => void                      | Setter for full option list that's used for searching                                                                                     |
| searchValue         | string                                              | Current value in searchbox                                                                                                                |
| deferredSearchValue | string                                              | Debounced search value                                                                                                                    |
| matches             | FilterOption[]                                      | List of options that match the current search input. This can be set externally or by the filter when there is a fullList and searchValue |
| setMatches          | (newMatches: FilterOption[]) => void                | Setter for matches                                                                                                                        |

</Section>

<Section hasExplanation>

### Filter state

The return of useFilterState can be used to implement filters with single selection. It contains the same props as the generic type and some more:

| Name           | Type                           | Description                                                                             |
| -------------- | ------------------------------ | --------------------------------------------------------------------------------------- |
| combobox       | ComboboxState                  | State used internally that handles rendered options and search                          |
| appliedItem    | FilterOption                   | Option that is currently applied.                                                       |
| setAppliedItem | (option: FilterOption) => void | Setter for appliedItem                                                                  |
| getFromApplied | (key: string) => T             | Shorthand function for fetching any key from the attached object (value) on appliedItem |

</Section>

<Section hasExplanation>

### Filter multiple state

The return of useFilterMultipleState can be used to implement filters with multiple selection. It contains the same props as the generic type and some more:

| Name            | Type                            | Description                                                                              |
| --------------- | ------------------------------- | ---------------------------------------------------------------------------------------- |
| combobox        | ComboboxMultipleState           | State used internally that handles rendered options and search                           |
| appliedItems    | FilterOption[]                  | Options that are currently applied.                                                      |
| setAppliedItems | (items: FilterOption[]) => void | Setter for appliedItems                                                                  |
| getFromApplied  | (key: string) => T[]            | Shorthand function for fetching any key from the attached object (value) on appliedItems |

</Section>

<Section hasExplanation>

## Anatomy

There are four types of filters that can be composed with admin-ui's filter
components. They are implemented by nesting the composable filter components
to form specific structures.

</Section>

<Section>

### Basic filter composable component anatomy

```txt
FilterGroup
|__ FilterDisclosure
|__ FilterPopover
    |__ FilterListbox
    |   |__ FilterOptionRadio
    |   |__ FilterOptionRadio
    |   |__ . . .
    |__ FilterFooter
```

</Section>

<Section>
  
### Multiple selection filter composable component anatomy

```txt
FilterGroup
|__ FilterDisclosure
|__ FilterPopover
    |__ FilterListbox
    |   |__ FilterOptionCheckbox
    |   |__ FilterOptionCheckbox
    |   |__ . . .
    |__ FilterFooter
```

</Section>

<Section hasExplanation>

### Searchable filter composable component anatomy

The searchable filter is just an extension of the simple filter, with the addition of a searchbox.

```txt
FilterGroup
|__ FilterDisclosure
|__ FilterPopover
    |__ FilterSearchbox
    |__ FilterListbox
    |   |__ FilterOptionRadio
    |   |__ FilterOptionRadio
    |   |__ . . .
    |__ FilterFooter
```

</Section>

<Section hasExplanation>

### Searchable filter with multiple option selection anatomy

Multiselect searchable filter is just an extension of the multiple selection filter.

```txt
FilterGroup
|__ FilterDisclosure
|__ FilterPopover
    |__ FilterSearchbox
    |__ FilterListbox
    |   |__ FilterOptionCheckbox
    |   |__ FilterOptionCheckbox
    |   |__ . . .
    |__ FilterFooter
```

</Section>
